From 5312ba2d3c3986ab83cab2be1d28632695507215 Mon Sep 17 00:00:00 2001
From: Jan Janssen <jan.janssen@outlook.com>
Date: Tue, 5 Oct 2021 17:40:22 -0600
Subject: [PATCH] compiler fix

---
 tsase/Makefile                          | 4 ++--
 tsase/calculators/al/code/Makefile      | 2 +-
 tsase/calculators/lepspho/code/Makefile | 2 +-
 tsase/calculators/lj/code/Makefile      | 2 +-
 tsase/calculators/morse/code/Makefile   | 2 +-
 5 files changed, 6 insertions(+), 6 deletions(-)

diff --git a/tsase/Makefile b/tsase/Makefile
index 416495e..00156fd 100644
--- a/tsase/Makefile
+++ b/tsase/Makefile
@@ -1,8 +1,8 @@
 FCOMP=gnu95
 
 all:
-	python -c 'import compileall; compileall.compile_dir(".",force=True)' #quiet=True
-	find calculators -name 'Makefile' | xargs perl -pi -e 's/fcompiler=[\w]+/fcompiler=$(FCOMP)/g'
+	# python -c 'import compileall; compileall.compile_dir(".",force=True)' #quiet=True
+	# find calculators -name 'Makefile' | xargs perl -pi -e 's/fcompiler=[\w]+/fcompiler=$(FCOMP)/g'
 	cd calculators && $(MAKE)
 
 .PHONY: clean
diff --git a/tsase/calculators/al/code/Makefile b/tsase/calculators/al/code/Makefile
index 0ae9906..db57616 100644
--- a/tsase/calculators/al/code/Makefile
+++ b/tsase/calculators/al/code/Makefile
@@ -2,7 +2,7 @@ MOD = al_
 
 OUT = $(MOD).so
 ../$(OUT):
-	f2py -c --opt=-O2 --fcompiler=gnu95 *.f -m $(MOD)
+	f2py -c --opt="$(FFLAGS)" --f90exec=$(FC) *.f -m $(MOD)
 	mv -f $(MOD)*.so ..
 #	mv -f $(OUT) ..
 
diff --git a/tsase/calculators/lepspho/code/Makefile b/tsase/calculators/lepspho/code/Makefile
index a55e4f7..7370c6c 100644
--- a/tsase/calculators/lepspho/code/Makefile
+++ b/tsase/calculators/lepspho/code/Makefile
@@ -2,7 +2,7 @@ MOD = lepspho_
 
 OUT = $(MOD).so
 ../$(OUT):
-	f2py -c --opt=-O2 --fcompiler=gnu95 *.f -m $(MOD)
+	f2py -c --opt="$(FFLAGS)" --f90exec=$(FC) *.f -m $(MOD)
 	mv -f $(MOD)*.so ..
 #	mv -f $(OUT) ..
 
diff --git a/tsase/calculators/lj/code/Makefile b/tsase/calculators/lj/code/Makefile
index 66206fe..176ec70 100644
--- a/tsase/calculators/lj/code/Makefile
+++ b/tsase/calculators/lj/code/Makefile
@@ -2,7 +2,7 @@ MOD = lj_
 
 OUT = $(MOD).so
 ../$(OUT):
-	f2py -c --opt=-O2 --fcompiler=gnu95 *.f -m $(MOD)
+	f2py -c --opt="$(FFLAGS)" --f90exec=$(FC) *.f -m $(MOD)
 	mv -f $(MOD)*.so ..
 #	mv -f $(OUT) ..
 
diff --git a/tsase/calculators/morse/code/Makefile b/tsase/calculators/morse/code/Makefile
index 51b5780..136d1d5 100644
--- a/tsase/calculators/morse/code/Makefile
+++ b/tsase/calculators/morse/code/Makefile
@@ -2,7 +2,7 @@ MOD = morse_
 
 OUT = $(MOD).so
 ../$(OUT):
-	f2py -c --opt=-O2 --fcompiler=gnu95 *.f -m $(MOD)
+	f2py -c --opt="$(FFLAGS)" --f90exec=$(FC) *.f -m $(MOD)
 	mv -f *.so ..
 #	mv -f $(OUT) ..
 
